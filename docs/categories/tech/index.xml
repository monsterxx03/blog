<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Tech on Shining Moon</title>
    <link>https://blog.monsterxx03.com/categories/tech/</link>
    <description>Recent content in Tech on Shining Moon</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Fri, 29 Sep 2017 08:55:18 +0000</lastBuildDate>
    
	<atom:link href="https://blog.monsterxx03.com/categories/tech/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Get all invalid PTR record on  Route53</title>
      <link>https://blog.monsterxx03.com/2017/09/29/get-all-invalid-ptr-record-on-route53/</link>
      <pubDate>Fri, 29 Sep 2017 08:55:18 +0000</pubDate>
      
      <guid>https://blog.monsterxx03.com/2017/09/29/get-all-invalid-ptr-record-on-route53/</guid>
      <description>I use autoscaling group to manage stateless servers. Servers goes up and done every day.
Once server is up, I will add a PTR record for it&amp;#8217;s internal ip. But when it&amp;#8217;s down, I didn&amp;#8217;t cleanup the PTR record. As times fly, a lot of invalid PTR records left in Route53.
To cleanup those PTR record in realtime, you can write a lambda function, use server termination event as trigger.</description>
    </item>
    
    <item>
      <title>Build private static website on S3</title>
      <link>https://blog.monsterxx03.com/2017/08/19/build-private-staticwebsite-on-s3/</link>
      <pubDate>Sat, 19 Aug 2017 07:28:16 +0000</pubDate>
      
      <guid>https://blog.monsterxx03.com/2017/08/19/build-private-staticwebsite-on-s3/</guid>
      <description>Build static website on S3 is very easy, but by default, it can be accessed by open internet.It will be super helpful if we can build website only available in VPC. Then we can use it to host internal deb repo, doc site&amp;#8230;
Steps are very easy, you only need VPC endpoints and S3 bucket policy.
AWS api is open to internet, if you need to access S3 in VPC, your requests will pass through VPC&amp;#8217;s internet gateway or NAT gateway.</description>
    </item>
    
    <item>
      <title>Use redshift spectrum to do query on s3</title>
      <link>https://blog.monsterxx03.com/2017/07/21/use-redshift-spectrum-to-do-query-on-s3/</link>
      <pubDate>Fri, 21 Jul 2017 03:10:58 +0000</pubDate>
      
      <guid>https://blog.monsterxx03.com/2017/07/21/use-redshift-spectrum-to-do-query-on-s3/</guid>
      <description>ä½¿ç”¨ redshift spectrum æŸ¥è¯¢ S3 æ•°æ® é€šå¸¸ä½¿ç”¨ redshift åšæ•°æ®ä»“åº“çš„æ—¶å€™è¦åšå¤§é‡çš„ ETL å·¥ä½œï¼Œä¸€èˆ¬æµç¨‹æ˜¯æŠŠå„ç§æ¥æºçš„æ•°æ®æ£é¼“æ£é¼“ä¸¢åˆ° S3 ä¸Šå»ï¼Œå†ä» S3 å€’è…¾è¿› redshift. å¦‚æœä½ æœ‰å¤§é‡çš„å†å²æ•°æ®è¦å¯¼è¿› redshiftï¼Œè¿™ä¸ªè¿‡ç¨‹å°±ä¼šå¾ˆç—›è‹¦ï¼Œredshift å¯¹ä¸€æ¬¡å€’å…¥å¤§é‡æ•°æ®å¹¶ä¸å‹å¥½ï¼Œä½ è¦åˆ†æ‰¹æ¥åšã€‚
ä»Šå¹´4æœˆçš„æ—¶å€™ï¼Œ redshift å‘å¸ƒäº†ä¸€ä¸ªæ–°åŠŸèƒ½ spectrum, å¯ä»¥ä» redshift é‡Œç›´æ¥æŸ¥è¯¢ s3 ä¸Šçš„ç»“æ„åŒ–æ•°æ®ã€‚æœ€è¿‘æŠŠéƒ¨åˆ†æ•°æ®ä»“åº“ç›´æ¥è¿ç§»åˆ°äº† spectrum, æ­£å¥½æ¥è®²è®²ã€‚
åŠ¨æœº Glow çš„æ•°æ®ä»“åº“å»ºåœ¨ redshift ä¸Šï¼Œ åˆåˆ†æˆäº†ä¸¤ä¸ªé›†ç¾¤ï¼Œä¸€ä¸ª ssd çš„é›†ç¾¤å­˜æ”¾æœ€è¿‘ 4 ä¸ªæœˆçš„æ•°æ®ï¼Œä¾›äº§å“åˆ†æï¼Œmetrics report, debug ç­‰ç­‰ adhoc çš„æŸ¥è¯¢ã€‚4ä¸ªæœˆä¹‹å‰çš„æ•°æ®å­˜æ”¾åœ¨ä¸€ä¸ª hdd çš„é›†ç¾¤é‡Œï¼Œä¾¿å®œå®¹é‡å¤§ï¼ŒæŸ¥è¯¢æ…¢ã€‚
ä½†æ˜¯æ—¶é—´é•¿äº† hdd çš„é›†ç¾¤ä¹Ÿæ˜¯æœ‰æ‰©å®¹éœ€æ±‚çš„ï¼Œè€Œä½¿ç”¨é¢‘ç‡åˆå®åœ¨æ˜¯ä¸é«˜ï¼Œå…¶å®å¾ˆæµªè´¹, è¿™å°±æ˜¯è¿ç§»åˆ° spectrum çš„åŠ¨æœºã€‚
ä½¿ç”¨ Spectrum Redshift spectrum åº•å±‚å…¶å®æ˜¯åŸºäº AWS çš„å¦ä¸€ä¸ªæœåŠ¡ athena çš„ã€‚athena æ˜¯ä¸ª Presto å’Œ Hive æ‚äº¤äº§ç‰©ï¼Œ DDL ç”¨ Hive è¯­æ³•ï¼Œ æŸ¥è¯¢ç”¨çš„ sql ç”± Presto æ”¯æŒ, æ„Ÿè§‰æ€ªæ€ªçš„ï¼Œè¿™é‡Œä¸å¤šå±•å¼€è®² athena, çŸ¥é“ redshift spectrum å…¶å®æ˜¯é€šè¿‡ athena å¯¹æ¥çš„ s3 å°±è¡Œäº†ã€‚</description>
    </item>
    
    <item>
      <title>Enable coredump on ubuntu 16.04</title>
      <link>https://blog.monsterxx03.com/2017/07/15/__trashed/</link>
      <pubDate>Sat, 15 Jul 2017 02:35:52 +0000</pubDate>
      
      <guid>https://blog.monsterxx03.com/2017/07/15/__trashed/</guid>
      <description>Coredump file is useful for debuging program crash. This post will show several settings related to coredump.
Enable coredump If you run program from shell , enable coredump via unlimit -c unlimitedï¼Œ then check unlimit -a | grep core, if it shows unlimited, coredump is enabled for your current session.
If your program is hosted by systemd, you need to edit your program&amp;#8217;s service unit file&amp;#8217;s [Service] section, add LimitCORE=infinity to enable coredump.</description>
    </item>
    
    <item>
      <title>Build deb repository with fpm , aptly and s3</title>
      <link>https://blog.monsterxx03.com/2017/06/23/build-deb-repository-with-fpm-aptly-and-s3/</link>
      <pubDate>Fri, 23 Jun 2017 09:40:58 +0000</pubDate>
      
      <guid>https://blog.monsterxx03.com/2017/06/23/build-deb-repository-with-fpm-aptly-and-s3/</guid>
      <description>I&amp;#8217;m lazy, I don&amp;#8217;t want to be deb/rpm expert, I don&amp;#8217;t want to maintain repo server. I want as less maintenance effort as possible. ğŸ™‚
Combine tools fpm, aptly with aws s3, we can do it.
Use fpm to convert python package to deb fpm can transform python/gem/npm/dir/&amp;#8230; to deb/rpm/solaris/&amp;#8230; packages
Example:
fpm -s python -t deb -m xyj.asmy@gmail.com --verbose -v 0.10.1 --python-pip /usr/local/pip Flask  It will transform Flask 0.</description>
    </item>
    
    <item>
      <title>Debug python performance issue with pyflame</title>
      <link>https://blog.monsterxx03.com/2017/06/05/debug-python-performance-issue-with-pyflame/</link>
      <pubDate>Mon, 05 Jun 2017 09:50:44 +0000</pubDate>
      
      <guid>https://blog.monsterxx03.com/2017/06/05/debug-python-performance-issue-with-pyflame/</guid>
      <description>pyflame is an opensource tool developed by uber: https://github.com/uber/pyflame
It can take snapshots of running python process, combined with flamegraph.pl, can output flamegraph picture of python call stacks. Help analyze bottleneck of python program, needn&amp;#8217;t inject any perf code into your application, and overhead is very low.
Basic Usage sudo pyflame -s 10 -x -r 0.001 $pid | ./flamegraph.pl &amp;gt; perf.svg
 -s, how many seconds to run -r, sample rate (seconds)  Your output will be something like following:</description>
    </item>
    
    <item>
      <title>Designing data intensive application, reading notes, Part 2</title>
      <link>https://blog.monsterxx03.com/2017/05/17/designing-data-intensive-application-reading-notes-part-2/</link>
      <pubDate>Wed, 17 May 2017 09:12:44 +0000</pubDate>
      
      <guid>https://blog.monsterxx03.com/2017/05/17/designing-data-intensive-application-reading-notes-part-2/</guid>
      <description>Chapter 4, 5, 6
Encoding formats xml, json, msgpack are text based encoding format, they can&amp;#8217;t carry binary bytes (useless you encode them in base64, size grows 33%). And they cary schema definition with data, wast a lot of space.
thrift, protobuf are binary format, can take binary bytes, only carry data, the schema is defined with IDL(interface definition language). They have code generation tool to generate code to encode and decode data, along with check.</description>
    </item>
    
    <item>
      <title>Designing data intensive application, reading notes, Part 1</title>
      <link>https://blog.monsterxx03.com/2017/05/04/designing-data-intensive-application-reading-notes-part-1/</link>
      <pubDate>Thu, 04 May 2017 16:27:52 +0000</pubDate>
      
      <guid>https://blog.monsterxx03.com/2017/05/04/designing-data-intensive-application-reading-notes-part-1/</guid>
      <description>&lt;p&gt;Notes when reading chapter 2 &amp;#8220;Data models and query languages&amp;#8221;, chapter 3 &amp;#8220;Storage and retrieval&amp;#8221;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Infrastructure as Code</title>
      <link>https://blog.monsterxx03.com/2017/04/21/infrastructure-as-code/</link>
      <pubDate>Fri, 21 Apr 2017 16:25:07 +0000</pubDate>
      
      <guid>https://blog.monsterxx03.com/2017/04/21/infrastructure-as-code/</guid>
      <description>&lt;p&gt;Create virtual resource on AWS is very convenient, but how to manage them will be a problem when your size grow.&lt;/p&gt;

&lt;p&gt;You will come to:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;How to explain the detail online settings for your colleagues (like: how our prod vpc is setup?what&amp;#8217;s the DHCP option set?), navigate around AWS console is okay, but not convenient.&lt;/li&gt;
&lt;li&gt;Who did what to which resource at when? AWS have a service called &lt;code&gt;Config&lt;/code&gt;, can be used to track this change, but if you want to make things as clear as viewing git log, still a lot of works to do.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Ideally, we should manage AWS resources like code, all changes kept in VCS, so called &lt;code&gt;Infrastructure as Code&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;I&amp;#8217;ve tried three ways to do it:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;ansible&lt;/li&gt;
&lt;li&gt;CloudFormation&lt;/li&gt;
&lt;li&gt;terraform&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In this article, I&amp;#8217;ll compare them, however, the conclusion is to use terraform ğŸ™‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Concurrency in Go, Reading Notes</title>
      <link>https://blog.monsterxx03.com/2017/04/19/concurrency-in-go-reading-notes/</link>
      <pubDate>Wed, 19 Apr 2017 16:26:58 +0000</pubDate>
      
      <guid>https://blog.monsterxx03.com/2017/04/19/concurrency-in-go-reading-notes/</guid>
      <description>&lt;p&gt;A few notes taken when reading &lt;Concurrency in Go&gt;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>MySQL partition table</title>
      <link>https://blog.monsterxx03.com/2017/04/05/mysql-partition-table/</link>
      <pubDate>Wed, 05 Apr 2017 16:23:32 +0000</pubDate>
      
      <guid>https://blog.monsterxx03.com/2017/04/05/mysql-partition-table/</guid>
      <description>&lt;h1 id=&#34;overview&#34;&gt;Overview&lt;/h1&gt;

&lt;p&gt;MySQL has buildin partition table support, which can help split data accross multi tables,&lt;/p&gt;

&lt;p&gt;and provide a unified query interface as normal tables.&lt;/p&gt;

&lt;p&gt;Benefit:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Easy data management: If we need to archive old data, and our table is partitioned by datetime, we can drop old partition directly.&lt;/li&gt;
&lt;li&gt;Speed up query based on partition key(partitoin pruning)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Limit:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;For partition table, every unique key must use every column in table&amp;#8217;s partition expression(include primary key)&lt;/li&gt;
&lt;li&gt;For innodb engine, paritioned table can&amp;#8217;t have foreign key,and can&amp;#8217;t have columns referenced by foreign keys.&lt;/li&gt;
&lt;li&gt;For MyISAM engine, mysql version &amp;lt;= 5.6.5, DML operation will lock all partition as a whole.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>ElasticSearch cluster</title>
      <link>https://blog.monsterxx03.com/2017/03/22/elasticsearch-cluster/</link>
      <pubDate>Wed, 22 Mar 2017 16:22:32 +0000</pubDate>
      
      <guid>https://blog.monsterxx03.com/2017/03/22/elasticsearch-cluster/</guid>
      <description>&lt;p&gt;In this article, let&amp;#8217;s talk about ElasticSearch&amp;#8217;s cluster mode, which means multi nodes ElasticSearch.&lt;/p&gt;

&lt;h2 id=&#34;basic-concepts&#34;&gt;Basic concepts&lt;/h2&gt;

&lt;p&gt;cluster: A collection of server nodes with same &lt;code&gt;cluster.name&lt;/code&gt; settings in elasticsearch.yaml&lt;/p&gt;

&lt;p&gt;primary shards: Divide a index into multi parts(by default 5), shards of an index can be distributed over multi nodes. It enables scale index horizontally and make access to index parallelly(accross multi nodes).&lt;/p&gt;

&lt;p&gt;replicas: backup for shards, also replicas can handle search requests, which means you can scale your search capacity horizontally via replicas.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Bigtable notes</title>
      <link>https://blog.monsterxx03.com/2016/12/11/bigtable-notes/</link>
      <pubDate>Sun, 11 Dec 2016 16:20:24 +0000</pubDate>
      
      <guid>https://blog.monsterxx03.com/2016/12/11/bigtable-notes/</guid>
      <description>&lt;p&gt;æ‚ä¹±ç¬”è®°ï¼Œè¾…åŠ©è¯»paper.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>GFS notes</title>
      <link>https://blog.monsterxx03.com/2016/11/19/gfs-notes/</link>
      <pubDate>Sat, 19 Nov 2016 16:18:41 +0000</pubDate>
      
      <guid>https://blog.monsterxx03.com/2016/11/19/gfs-notes/</guid>
      <description>&lt;p&gt;çœ‹äº†ä¸‹å¾ˆä¹…å‰ google çš„ GFS è®ºæ–‡ï¼Œ åšç‚¹ç¬”è®°ã€‚&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Migrate to encrypted RDS</title>
      <link>https://blog.monsterxx03.com/2016/10/28/migrate-to-encrypted-rds/</link>
      <pubDate>Fri, 28 Oct 2016 16:17:30 +0000</pubDate>
      
      <guid>https://blog.monsterxx03.com/2016/10/28/migrate-to-encrypted-rds/</guid>
      <description>&lt;p&gt;æœ€è¿‘å…¬å¸åœ¨åš HIPAA Compliance ç›¸å…³çš„äº‹æƒ…ï¼Œå…¶ä¸­è¦æ±‚ä¹‹ä¸€æ˜¯æ‰€æœ‰dbéœ€è¦å¼€å¯encryption.&lt;/p&gt;

&lt;p&gt;æ¯”è¾ƒéº»çƒ¦çš„æ˜¯rds çš„encryption åªèƒ½åœ¨åˆ›å»ºçš„æ—¶å€™è®¾å®šï¼Œæ— æ³•ä¹‹åä¿®æ”¹, æ‰€ä»¥å¿…é¡»å¯¹çº¿ä¸Šçš„db åšä¸€æ¬¡ migration.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>MySQL ç´¢å¼•ä¼˜åŒ–</title>
      <link>https://blog.monsterxx03.com/2016/07/26/mysql-index-optimization/</link>
      <pubDate>Tue, 26 Jul 2016 16:13:54 +0000</pubDate>
      
      <guid>https://blog.monsterxx03.com/2016/07/26/mysql-index-optimization/</guid>
      <description>&lt;p&gt;ä»€ä¹ˆæ˜¯ç´¢å¼•,ç´¢å¼•æ€ä¹ˆå»ºè¿™äº›åŸºæœ¬çš„å°±è·³è¿‡ä¸è°ˆäº†,æ•´ç†ä¸€äº›å‰æ®µæ—¶é—´ä¼˜åŒ–çº¿ä¸Š SQL æŸ¥è¯¢æ—¶ç¢°åˆ°çš„ä¸€äº›é—®é¢˜. ä¸»è¦è§£å†³ä¸‹é¢å‡ ä¸ªé—®é¢˜:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å»ºç«‹ç´¢å¼•æ€æ ·é€‰æ‹©åˆé€‚çš„åˆ—.&lt;/li&gt;
&lt;li&gt;æ€æ ·è®© SQL èƒ½æœ‰æ•ˆåˆ©ç”¨ç´¢å¼•.&lt;/li&gt;
&lt;li&gt;å¦‚æœå¯¹ SQL æ•ˆç‡è¿›è¡Œè¯„ä¼°(å³è®¾ç½®ç´¢å¼•å‰åæ˜¯å¦çœŸçš„æœ‰æ€§èƒ½æå‡).&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>Redshift as data warehouse</title>
      <link>https://blog.monsterxx03.com/2016/07/16/redshift-as-data-warehouse/</link>
      <pubDate>Sat, 16 Jul 2016 16:11:39 +0000</pubDate>
      
      <guid>https://blog.monsterxx03.com/2016/07/16/redshift-as-data-warehouse/</guid>
      <description>&lt;p&gt;Glow çš„ server infrastructure å…¨éƒ¨æ­å»ºåœ¨ AWS ä¸Šï¼Œä¸€èˆ¬è¦é€‰æ‹©ä¸€äº›åŸºç¡€æœåŠ¡çš„æ—¶å€™ï¼Œæ€»æ˜¯å…ˆçœ‹ AWS, åªè¦åŠŸèƒ½å’Œæˆæœ¬ç¬¦åˆè¦æ±‚ï¼Œä¸ä¼šç‰¹æ„é€‰æ‹©å¼€æºæ–¹æ¡ˆã€‚&lt;/p&gt;

&lt;p&gt;æ•°æ®ä»“åº“æˆ‘ä»¬é€‰æ‹©äº† AWS çš„ Redshift.&lt;/p&gt;

&lt;p&gt;åœ¨ä¸€å¹´å¤šçš„ä½¿ç”¨è¿‡ç¨‹ä¸­ Redshift çš„æ€§èƒ½å’Œç¨³å®šæ€§éƒ½ä¸é”™, å½“ç„¶ä¹Ÿæœ‰ä¸€äº›å‘, è¿™é‡Œæ•´ç†ä¸‹åœ¨ä½¿ç”¨ redshift çš„è¿‡ç¨‹ä¸­çš„ä¸€äº›ç»éªŒå’Œé‡åˆ°çš„å‘.&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;</description>
    </item>
    
    <item>
      <title>MySQL innodb buffer pool</title>
      <link>https://blog.monsterxx03.com/2016/07/16/mysql-innodb-buffer-pool/</link>
      <pubDate>Sat, 16 Jul 2016 16:07:14 +0000</pubDate>
      
      <guid>https://blog.monsterxx03.com/2016/07/16/mysql-innodb-buffer-pool/</guid>
      <description>&lt;p&gt;æœ€è¿‘åœ¨å¯¹å…¬å¸çš„ MySQL æœåŠ¡å™¨åšæ€§èƒ½ä¼˜åŒ–, ä¸€ç›´å¯¹ innodb çš„å†…å­˜ä½¿ç”¨æ–¹å¼ä¸æ˜¯å¾ˆæ¸…æ¥š, ä¹˜è¿™æœºä¼šåšç‚¹æ€»ç»“.&lt;/p&gt;

&lt;p&gt;åœ¨é…ç½® MySQL çš„æ—¶å€™, ä¸€èˆ¬éƒ½ä¼šéœ€è¦è®¾ç½® _innodb_buffer_pool&lt;em&gt;size&lt;/em&gt;, åœ¨å°† MySQL è®¾ç½®åœ¨å•ç‹¬çš„æœåŠ¡å™¨ä¸Šæ—¶, ä¸€èˆ¬ä¼šè®¾ç½®ä¸ºç‰©ç†å†…å­˜çš„80%.&lt;/p&gt;

&lt;p&gt;ä¹‹å‰ä¸€ç›´ç–‘æƒ‘ MySQL æ˜¯æ€ä¹ˆç¼“å­˜æ•°æ®çš„(ä¸æ˜¯æŒ‡query cache), ç›´è§‰åº”è¯¥æ˜¯LRU, ä½†å¦‚æœ query ä¸€ä¸‹ä»ç£ç›˜ä¸Šè¯»å–å¤§é‡çš„æ•°æ®çš„è¯(å…¨è¡¨æ‰«ææˆ–æ˜¯ mysqldump), æ˜¯ä¸æ˜¯å¾ˆå®¹æ˜“å°±ä¼šæŠŠçƒ­æ•°æ®ç»™è¸¢å‡ºå»?&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;</description>
    </item>
    
  </channel>
</rss>